/**************************************************************************
Cabdulahi Hussein
Homework electricBill.cpp
03/02/2025
This program will calculate the electric bill for users.
**************************************************************************/
#include <iostream>
#include <iomanip> // for rounded amount
using namespace std;

int main()
{
    // Input needed from users
    int month; // month
    int cM; // current meter
    int pM; // previous meter
    string FN; // first name
    double flat = 8.50; // flat rate for 0-400 kWh
    double extraChargeRate; // extra charge per kWh over 400

    // asking for user input
    cout << "Enter your first name: ";
    cin >> FN;

    cout << "Welcome, " << FN << "!" << endl;
    cout << "This program will ask for the month and current and previous meter readings then calculate your electric bill. Please press \"ENTER\" to continue." << endl;
    cin.ignore();
    cin.get();

    // grab month from user
    cout << "Enter the month: ";
    cin >> month;

    // first validate the month
    if (month < 1 || month > 12)
    {
      cout << month << " is an invalid month \n" << endl;
        return 0; // Exit here
    }

    // get meter readings
    cout << "Enter the current meter reading: ";
    cin >> cM;
    cout << "Enter the previous meter reading: ";
    cin >> pM;

    // calculate and validate meter readings
    if (cM < 0 || pM < 0 || cM < pM)
    {
      cout << "The readings are invalid \n" << endl;
        return 0; // Exit the program
    }

    // charge rate based on month
    if (month >= 5 && month <= 9) // May-Sept rates
    {
        extraChargeRate = 7.525;
    }
    else // Other months
    {
        extraChargeRate = 6.575;
    }

    // calculate electricity consumption
    int consumed_total = cM - pM; // Total kWh consumed
    double totalBill = flat; // Start with base rate

    // Apply additional charge if usage is over 400 kWh
    if (consumed_total > 400)
    {
        totalBill += (consumed_total - 400) * (extraChargeRate / 100.0); // Convert cents to dollars
    }

    // Display total amount due fixed and rounded to 2 places
    cout <<endl;
    cout << fixed << setprecision(2);
    cout <<"You consumed " << consumed_total << " KWH and your amount due is $" << totalBill <<"\n"<< endl;

    return 0;
}
